<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="The Linguistic Web of Luxembourg - Data Visualization">
    <title>The Linguistic Web of Luxembourg - Julio Garbers</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;1,400&family=Source+Sans+3:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --color-bg: #faf9f7;
            --color-bg-alt: #f0eeea;
            --color-card: #ffffff;
            --color-text: #2d2d2d;
            --color-text-secondary: #555;
            --color-text-muted: #666;
            --color-accent: #1a5f7a;
            --color-accent-hover: #134a5f;
            --color-border: #e0ddd8;
            --font-display: 'Playfair Display', Georgia, serif;
            --font-body: 'Source Sans 3', 'Segoe UI', sans-serif;
            --font-mono: 'JetBrains Mono', monospace;
            --max-width: 900px;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.06);

            .stats-banner-title {
                font-size: 1rem;
                font-weight: 600;
                color: var(--color-text);
                text-transform: uppercase;
                letter-spacing: 0.08em;
                margin-bottom: 0.75rem;
                text-align: center;
            }
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-body);
            font-size: 17px;
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        a {
            color: var(--color-accent);
            text-decoration: none;
            transition: color 0.2s ease;
        }

        a:hover {
            color: var(--color-accent-hover);
            text-decoration: underline;
        }

        .container {
            max-width: var(--max-width);
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* Header */
        header {
            background: white;
            border-bottom: 1px solid var(--color-border);
            position: relative;
            z-index: 100;
            box-shadow: var(--shadow-sm);
        }

        header .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            padding-bottom: 1rem;
        }

        .logo {
            font-family: var(--font-display);
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--color-text);
        }

        .logo:hover {
            color: var(--color-accent);
            text-decoration: none;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        nav a {
            color: var(--color-text-muted);
            font-weight: 500;
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            padding: 0.5rem 0;
            position: relative;
        }

        nav a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--color-accent);
            transition: width 0.3s ease;
        }

        nav a:hover::after,
        nav a.active::after {
            width: 100%;
        }

        nav a:hover,
        nav a.active {
            color: var(--color-accent);
            text-decoration: none;
        }

        .menu-toggle {
            display: none;
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
        }

        /* Main */
        main {
            flex: 1;
            padding: 3rem 0;
        }

        /* Back link */
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--color-text-muted);
            margin-bottom: 2rem;
        }

        .back-link:hover {
            color: var(--color-accent);
            text-decoration: none;
        }

        /* Post Header - Updated */
        .post-header {
            margin-bottom: 2.5rem;
            padding: 2.5rem;
            background: var(--color-card);
            border: 1px solid var(--color-border);
            border-radius: 12px;
            box-shadow: var(--shadow-md);
        }

        .post-meta {
            font-family: var(--font-mono);
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: var(--color-accent);
            margin-bottom: 1.25rem;
            display: inline-block;
            background: rgba(26, 95, 122, 0.08);
            padding: 0.35rem 0.75rem;
            border-radius: 4px;
        }

        h1 {
            font-family: var(--font-display);
            font-size: 2.5rem;
            font-weight: 700;
            line-height: 1.25;
            margin-bottom: 1.25rem;
            letter-spacing: -0.02em;
            color: var(--color-text);
        }

        .post-subtitle {
            font-size: 1.1rem;
            color: var(--color-text-secondary);
            font-weight: 400;
            line-height: 1.7;
            max-width: 650px;
        }

        /* Stats Banner - Updated for 2x4 grid */
        .stats-banner {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1px;
            background: var(--color-border);
            border-radius: 12px;
            overflow: hidden;
            margin: 2.5rem 0;
        }

        .stat-item {
            background: var(--color-card);
            padding: 1.25rem 1rem;
            text-align: center;
        }

        .stat-value {
            font-family: var(--font-display);
            font-size: 1.75rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        /* Language-specific colors */
        .stat-value.fr {
            color: #2563eb;
        }

        .stat-value.de {
            color: #dc2626;
        }

        .stat-value.en {
            color: #059669;
        }

        .stat-value.lb {
            color: #d97706;
        }

        .stat-value.pt {
            color: #7c3aed;
        }

        .stat-value.nl {
            color: #0891b2;
        }

        .stat-value.other {
            color: #6b7280;
        }

        .stat-value.multi {
            color: var(--color-accent);
        }

        .stat-label {
            font-size: 0.7rem;
            color: var(--color-text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Sections */
        .section {
            margin: 4rem 0;
        }

        .section-number {
            display: none;
        }

        h2 {
            font-family: var(--font-display);
            font-size: 1.75rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
        }

        .section-description {
            font-size: 1rem;
            color: var(--color-text-secondary);
            max-width: 700px;
        }

        /* Chart Container */
        .chart-wrapper {
            background: var(--color-card);
            border: 1px solid var(--color-border);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            box-shadow: var(--shadow-md);
        }

        .chart-title {
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--color-text-muted);
            text-transform: uppercase;
            letter-spacing: 0.08em;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--color-border);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 1.25rem;
            justify-content: center;
            margin: 1rem 0;
            padding: 0.75rem;
            background: var(--color-bg-alt);
            border-radius: 8px;
        }

        .chart-note {
            font-size: 0.8rem;
            color: var(--color-text-muted);
            font-style: italic;
            margin-top: 1rem;
            padding-top: 0.75rem;
            border-top: 1px solid var(--color-border);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.85rem;
            color: var(--color-text-muted);
        }

        .legend-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        /* Insight Cards */
        .insight-card {
            background: linear-gradient(135deg, rgba(26, 95, 122, 0.08) 0%, rgba(26, 95, 122, 0.04) 100%);
            border: 1px solid rgba(26, 95, 122, 0.2);
            border-left: 4px solid var(--color-accent);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            margin-top: 0;
        }

        .chart-wrapper+.insight-card {
            margin-top: 0;
        }

        .insight-card h3 {
            font-family: var(--font-display);
            font-size: 1.1rem;
            margin-bottom: 0.75rem;
            color: var(--color-accent);
        }

        .insight-card p {
            color: var(--color-text-secondary);
            font-size: 0.95rem;
            line-height: 1.7;
        }

        /* Methodology */
        .methodology {
            background: var(--color-card);
            border: 1px solid var(--color-border);
            border-radius: 12px;
            padding: 2rem;
            margin: 3rem 0;
        }

        .methodology h3 {
            font-family: var(--font-display);
            font-size: 1.35rem;
            margin-bottom: 1rem;
        }

        .methodology>p {
            color: var(--color-text-secondary);
            margin-bottom: 1.5rem;
        }

        .pipeline-steps {
            display: grid;
            gap: 1.25rem;
        }

        .pipeline-step {
            display: flex;
            gap: 1rem;
            align-items: flex-start;
        }

        .step-number {
            flex-shrink: 0;
            width: 32px;
            height: 32px;
            background: var(--color-accent);
            color: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: var(--font-mono);
            font-size: 0.85rem;
            font-weight: 600;
        }

        .step-content h4 {
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .step-content p {
            font-size: 0.9rem;
            color: var(--color-text-secondary);
        }

        .step-content code {
            font-family: var(--font-mono);
            font-size: 0.85em;
            background: var(--color-bg-alt);
            padding: 0.1em 0.3em;
            border-radius: 3px;
        }

        /* Footer */
        footer {
            background: white;
            border-top: 1px solid var(--color-border);
            padding: 1.5rem 0;
            margin-top: auto;
        }

        footer .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: var(--color-text-muted);
        }

        /* Loading */
        .loading {
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 1rem;
        }

        .loading-spinner {
            width: 36px;
            height: 36px;
            border: 3px solid var(--color-border);
            border-top-color: var(--color-accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .content {
            display: none;
        }

        .content.loaded {
            display: block;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 0 1.25rem;
            }

            h1 {
                font-size: 2rem;
            }

            .post-header {
                padding: 1.5rem;
            }

            .stats-banner {
                grid-template-columns: repeat(2, 1fr);
            }

            nav ul {
                gap: 1rem;
            }

            nav a {
                font-size: 0.85rem;
            }
        }

        @media (max-width: 600px) {
            .menu-toggle {
                display: block;
            }

            nav ul {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: white;
                flex-direction: column;
                padding: 1rem 2rem;
                border-bottom: 1px solid var(--color-border);
                gap: 0;
            }

            nav ul.active {
                display: flex;
            }

            nav li {
                border-bottom: 1px solid var(--color-border);
            }

            nav li:last-child {
                border-bottom: none;
            }

            nav a {
                display: block;
                padding: 0.75rem 0;
            }

            header .container {
                position: relative;
            }
        }
    </style>
</head>

<body>
    <header>
        <div class="container">
            <a href="../../index.html" class="logo">Julio Garbers</a>
            <button class="menu-toggle" aria-label="Toggle menu">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
            </button>
            <nav>
                <ul>
                    <li><a href="../../index.html">Home</a></li>
                    <li><a href="../../research.html">Research</a></li>
                    <li><a href="../../policy.html">Policy</a></li>
                    <li><a href="../../blog.html" class="active">Blog</a></li>
                    <li><a href="../../cv.html">CV</a></li>
                    <li>
                        <a href="https://github.com/julio-garbers" target="_blank" rel="noopener" class="social-link"
                            aria-label="GitHub">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" />
                            </svg>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <div class="container">
            <a href="../../blog.html" class="back-link">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="19" y1="12" x2="5" y2="12"></line>
                    <polyline points="12 19 5 12 12 5"></polyline>
                </svg>
                Back to Blog
            </a>

            <!-- Loading State -->
            <div class="loading" id="loading">
                <div class="loading-spinner"></div>
                <p style="color: var(--color-text-muted);">Loading data...</p>
            </div>

            <!-- Main Content -->
            <div class="content" id="content">
                <header class="post-header">
                    <h1>The Linguistic Web of Luxembourg</h1>
                    <p class="post-subtitle" id="hero-subtitle"></p>
                </header>

                <p class="stats-banner-title" id="stats-banner-title"></p>
                <div class="stats-banner" id="stats-banner"></div>

                <!-- Section 1 -->
                <section class="section">
                    <span class="section-number">01 ‚Äî Language Availability</span>
                    <h2>The Language Landscape</h2>
                    <p class="section-description">
                        Which languages do Luxembourg websites make available to visitors?
                        <!-- This chart tracks language options offered through navigation menus and language switchers ‚Äî not
                        the language a page happens to be written in, but the full set of languages each site supports. -->
                    </p>

                    <div class="chart-wrapper">
                        <div class="chart-title">Language availability</div>
                        <div id="chart-languages" style="height: 400px;"></div>
                        <div class="legend">
                            <div class="legend-item"><span class="legend-dot" style="background: #2563eb;"></span>
                                French</div>
                            <div class="legend-item"><span class="legend-dot" style="background: #dc2626;"></span>
                                German</div>
                            <div class="legend-item"><span class="legend-dot" style="background: #059669;"></span>
                                English</div>
                            <div class="legend-item"><span class="legend-dot" style="background: #d97706;"></span>
                                Luxembourgish</div>
                            <div class="legend-item"><span class="legend-dot" style="background: #7c3aed;"></span>
                                Portuguese</div>
                            <div class="legend-item"><span class="legend-dot" style="background: #0891b2;"></span> Dutch
                            </div>
                            <div class="legend-item"><span class="legend-dot" style="background: #6b7280;"></span> Other
                            </div>
                        </div>
                        <p class="chart-note">Note: Percentages indicate share of websites offering each language. Sites
                            can offer multiple languages, so percentages do not sum to 100%.</p>
                    </div>

                    <div class="insight-card">
                        <h3>Key Findings</h3>
                        <p id="insight-1"></p>
                    </div>

                </section>

                <!-- Section 2 -->
                <section class="section">
                    <span class="section-number">02 ‚Äî Multilingual Web</span>
                    <h2>Beyond Monolingual</h2>
                    <p class="section-description">
                        Is Luxembourg's constitutional trilingualism (French, German, Luxembourgish)
                        reflected online?
                    </p>

                    <div class="chart-wrapper">
                        <div class="chart-title">Multilingual breakdown</div>
                        <div id="chart-multilingual" style="height: 350px;"></div>
                        <p class="chart-note" id="note-multilingual"></p>
                    </div>
                    <div class="insight-card">
                        <h3>Key Findings</h3>
                        <p id="insight-2"></p>
                    </div>
                </section>

                <!-- Section 3 -->
                <section class="section">
                    <span class="section-number">03 ‚Äî Language Configurations</span>
                    <h2>Language Configurations</h2>
                    <p class="section-description" id="combinations-description"></p>

                    <div class="chart-wrapper">
                        <div class="chart-title" id="combinations-title">Most common language combinations</div>
                        <div id="chart-combinations" style="height: 450px;"></div>
                        <p class="chart-note" id="note-combinations"></p>
                    </div>

                    <div class="insight-card">
                        <h3>Key Findings</h3>
                        <p id="insight-3"></p>
                    </div>
                </section>

                <!-- Methodology -->
                <div class="methodology">
                    <h3>üìê Methodology</h3>
                    <p>
                        This analysis detects language <em>availability</em> ‚Äî which languages a website offers to
                        visitors ‚Äî
                        rather than just language <em>content</em> (what language a page happens to be written in).
                        This distinction matters because analyzing page content alone only reveals the language of that
                        specific page,
                        not the full set of languages a site offers. By detecting language switchers and hreflang tags,
                        I can identify multilingual sites even when only one language version was archived.
                    </p>
                    <p style="margin-top: 1rem; color: var(--color-text-secondary);">
                        I use a three-tier detection pipeline, prioritizing the most reliable signals first.
                    </p>
                    <div class="pipeline-steps" id="methodology-steps"></div>
                    <p class="chart-note" id="methodology-note"></p>
                    <p class="chart-note" style="margin-top: 0.5rem;">
                        All scripts are available on <a href="https://github.com/YOUR_USERNAME/YOUR_REPO"
                            target="_blank">GitHub</a>.
                    </p>
                </div>

                <div class="methodology">
                    <h3>üìö Citation</h3>
                    <p style="color: var(--color-text-secondary); margin-bottom: 1rem;">
                        For attribution, please cite this work as:
                    </p>
                    <pre
                        style="background: var(--color-bg-alt); padding: 1rem; border-radius: 6px; font-size: 0.85rem; overflow-x: auto; white-space: pre-wrap; margin-bottom: 1.5rem;"><code>Garbers, J. (2025, January). The Linguistic Web of Luxembourg. Retrieved from https://juliogarbers.com/posts/website_languages_lux/</code></pre>
                    <p style="color: var(--color-text-secondary); margin-bottom: 0.75rem;">
                        BibTeX citation:
                    </p>
                    <pre
                        style="background: var(--color-bg-alt); padding: 1rem; border-radius: 6px; font-size: 0.85rem; overflow-x: auto; white-space: pre-wrap;"><code>@misc{garbers2025linguistic,
                        author = {Garbers, Julio},
                        title = {The Linguistic Web of Luxembourg},
                        url = {https://juliogarbers.com/posts/website_languages_lux/},
                        year = {2025}
                    }</code></pre>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <span>&copy; 2026 Julio Garbers</span>
            <a href="mailto:julio.garbers@liser.lu">julio.garbers@liser.lu</a>
        </div>
    </footer>

    <script>
        // Mobile menu toggle
        const menuToggle = document.querySelector('.menu-toggle');
        const navUl = document.querySelector('nav ul');
        menuToggle.addEventListener('click', () => navUl.classList.toggle('active'));

        // Configuration
        const DATA_URL = 'stats.json';

        const langColors = { fr: '#2563eb', de: '#dc2626', en: '#059669', lb: '#d97706', pt: '#7c3aed', nl: '#0891b2', other: '#6b7280' };
        const langNames = { fr: 'French', de: 'German', en: 'English', lb: 'Luxembourgish', pt: 'Portuguese', nl: 'Dutch', other: 'Other' };

        const lightLayout = {
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { family: 'Source Sans 3, sans-serif', color: '#666', size: 13 },
            margin: { t: 20, r: 30, b: 50, l: 60 },
            xaxis: {
                gridcolor: 'rgba(0,0,0,0.06)',
                linecolor: 'rgba(0,0,0,0.1)',
                tickfont: { size: 12 },
                tickcolor: 'rgba(0,0,0,0.1)'
            },
            yaxis: {
                gridcolor: 'rgba(0,0,0,0.06)',
                linecolor: 'rgba(0,0,0,0.1)',
                tickfont: { size: 12 },
                tickcolor: 'rgba(0,0,0,0.1)'
            },
            hoverlabel: {
                bgcolor: '#fff',
                bordercolor: 'rgba(0,0,0,0.1)',
                font: { family: 'Source Sans 3, sans-serif', color: '#2d2d2d', size: 13 }
            }
        };

        const plotlyConfig = { displayModeBar: false, responsive: true };

        function formatNumber(n) { return n.toLocaleString(); }
        function formatChange(n) { return (n >= 0 ? '+' : '') + n.toFixed(1); }

        async function loadData() {
            try {
                const response = await fetch(DATA_URL);
                if (!response.ok) throw new Error('Failed to load data');
                return await response.json();
            } catch (error) {
                console.error('Error loading data:', error);
                document.getElementById('loading').innerHTML = `<p style="color: #dc2626;">Error loading data. Make sure stats.json exists.</p>`;
                throw error;
            }
        }

        function populateContent(data) {
            const { summary, methodology } = data;

            document.getElementById('hero-subtitle').innerHTML =
                `Using CommonCrawl data, I analyzed ${formatNumber(summary.total_website_years)} pages of Luxembourg websites from ${summary.first_year} 
                to ${summary.last_year}, detecting which languages each website offers. Below, I explore language trends over time, multilingual patterns, 
                and the most common language configurations.`
            document.getElementById('stats-banner-title').textContent =
                `Website Languages in ${summary.last_year}`;

            document.getElementById('stats-banner').innerHTML = `
                <div class="stat-item"><div class="stat-value fr">${Math.round(summary.fr_last)}%</div><div class="stat-label">French</div></div>
                <div class="stat-item"><div class="stat-value de">${Math.round(summary.de_last)}%</div><div class="stat-label">German</div></div>
                <div class="stat-item"><div class="stat-value en">${Math.round(summary.en_last)}%</div><div class="stat-label">English</div></div>
                <div class="stat-item"><div class="stat-value lb">${Math.round(summary.lb_last)}%</div><div class="stat-label">Luxembourgish</div></div>
                <div class="stat-item"><div class="stat-value pt">${Math.round(summary.pt_last || 0)}%</div><div class="stat-label">Portuguese</div></div>
                <div class="stat-item"><div class="stat-value nl">${Math.round(summary.nl_last || 0)}%</div><div class="stat-label">Dutch</div></div>
                <div class="stat-item"><div class="stat-value other">${Math.round(summary.other_last || 0)}%</div><div class="stat-label">Other</div></div>
                <div class="stat-item"><div class="stat-value multi">${Math.round(summary.multilingual_last)}%</div><div class="stat-label">Multilingual</div></div>
            `;

            document.getElementById('insight-1').innerHTML = `
                French dominates at ${Math.round(summary.fr_last)}% and has remained remarkably stable over the decade. 
                I don't have a good explanation for the sharp 2019 decrease in German, English, and Luxembourgish on websites.
                <br><br>
                The increase in websites in Luxembourgish from 2016‚Äì2018 coincides with the government's 
                <em>"Strategie fir d'Promotioun vun der L√´tzebuerger Sprooch"</em>, launched in March 2017. 
                This plan aimed to increase digital presence and standardization of Luxembourgish, 
                culminating in the July 2018 law establishing a Language Commissioner and the Centre for the 
                Luxembourgish Language. 
                (<a href="https://gouvernement.lu/en/dossiers/2018/langue-luxembourgeoise.html" target="_blank">source</a>)
                <br><br>
                Portuguese speakers make up <strong>14.5% of Luxembourg's population</strong> ‚Äî the largest immigrant community ‚Äî 
                but only <strong>${summary.pt_last.toFixed(1)}% of websites</strong> offer Portuguese content. 
                (<a href="https://statistiques.public.lu/en/recensement/nationalites.html" target="_blank">source</a>)
            `;

            document.getElementById('insight-2').innerHTML = `
                Contrary to what one might expect, the share of multilingual websites has slightly <strong>decreased</strong> ‚Äî 
                from ${Math.round(summary.multilingual_first)}% in ${summary.first_year} to ${Math.round(summary.multilingual_last)}% in ${summary.last_year}. 
                <br><br>
                The majority of Luxembourg websites (${Math.round(100 - summary.multilingual_last)}%) remain monolingual, 
                with French-only sites being the most common configuration.
            `;

            const combos = data.combinations;
            const getCombo = (name) => combos.find(c => c.combo === name)?.pct || 0;

            document.getElementById('insight-3').innerHTML = `
                French-only sites dominate at ${getCombo('French')}%, followed by English-only at ${getCombo('English')}%, 
                even though English isn't an official language. 
                <br><br>
                The French + German pairing (${getCombo('French + German')}%) has been overtaken by French + English (${getCombo('English + French')}%).
                <br><br>
                The full quadrilingual setup (French + German + English + Luxembourgish) remains rare at just ${getCombo('English + French + German + Luxembourgish')}%.
                <br><br>
                Notably, Luxembourgish-only sites sit at the bottom (${getCombo('Luxembourgish')}%) ‚Äî the national language 
                rarely stands alone online, almost always appearing alongside French or German.
            `;

            document.getElementById('combinations-description').innerHTML =
                `What are the most common language configurations?`;

            document.getElementById('combinations-title').textContent =
                `Most common language configurations (${data.combinations_year})`;

            document.getElementById('methodology-steps').innerHTML = `
                <div class="pipeline-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h4>Data Collection</h4>
                        <p>I extracted ${formatNumber(methodology.total_website_years)} website-year observations from 
                        <a href="https://commoncrawl.org/" target="_blank">CommonCrawl</a> archives (${summary.first_year}‚Äì${summary.last_year}), 
                        filtering for .lu domains. CommonCrawl provides free, publicly available web archives ‚Äî 
                        enabling reproducible research without requiring custom crawling infrastructure.</p>
                    </div>
                </div>
                <div class="pipeline-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h4>Hreflang Extraction</h4>
                        <p>I scanned HTML for <code>hreflang</code> tags ‚Äî the W3C standard for declaring language alternatives. 
                        When present, these tags explicitly list all language versions a site offers, making them the most 
                        reliable signal. Found in ${formatNumber(methodology.regex_extracted)} website-years (${Math.round(methodology.regex_extracted / methodology.total_website_years * 100)}%).</p>
                    </div>
                </div>
                <div class="pipeline-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h4>LLM Detection</h4>
                        <p>For sites without hreflang tags, I used Mistral's <a href="https://mistral.ai/news/magistral" target="_blank">Magistral</a> 
                        model to detect language switchers in HTML navigation elements. LLMs can identify patterns like "FR | DE | EN" menus 
                        that rule-based approaches miss. Applied to ${formatNumber(methodology.llm_extracted)} website-years (${Math.round(methodology.llm_extracted / methodology.total_website_years * 100)}%).</p>
                    </div>
                </div>
                <div class="pipeline-step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h4>FastText Fallback</h4>
                        <p>Sites with no detected language switcher are assumed monolingual. I classified their primary language 
                        using <a href="https://fasttext.cc/docs/en/language-identification.html" target="_blank">FastText</a>, 
                        a lightweight model trained on Wikipedia. Applied to ${formatNumber(methodology.fasttext_applied)} website-years (${Math.round(methodology.fasttext_applied / methodology.total_website_years * 100)}%).</p>
                    </div>
                </div>
            `;

            document.getElementById('methodology-note').innerHTML =
                `Note: ${formatNumber(methodology.excluded_unknown)} website-years (${(methodology.excluded_unknown / methodology.total_website_years * 100).toFixed(1)}%) had insufficient text for language classification and were excluded from the analysis.`;

            document.getElementById('note-multilingual').innerHTML =
                `Note: Based on websites with at least one detected language. ${formatNumber(methodology.excluded_unknown)} sites with insufficient text for classification were excluded.`;

            document.getElementById('note-combinations').innerHTML =
                `Note: Based on ${formatNumber(summary.total_websites_latest)} websites in ${summary.last_year}. Only the four main languages (French, German, English, Luxembourgish) are shown in combinations.`;
        }

        function renderLanguageChart(yearlyData) {
            const traces = ['fr', 'de', 'en', 'lb', 'pt', 'nl', 'other'].map(lang => ({
                x: yearlyData.map(d => d.year),
                y: yearlyData.map(d => d[`${lang}_pct`]),
                name: langNames[lang],
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: langColors[lang], width: 3, shape: 'spline', smoothing: 0.8 },
                marker: { size: 6, color: langColors[lang] },
                hovertemplate: `<b>${langNames[lang]}</b><br>%{y:.1f}% of websites<br>Year: %{x}<extra></extra>`
            }));
            const maxPct = Math.max(...yearlyData.map(d => Math.max(d.fr_pct, d.de_pct, d.en_pct)));
            Plotly.newPlot('chart-languages', traces, {
                ...lightLayout,
                yaxis: { ...lightLayout.yaxis, title: { text: '% of websites', standoff: 15 }, range: [0, maxPct + 5], ticksuffix: '%' },
                xaxis: { ...lightLayout.xaxis, dtick: 1 },
                showlegend: false
            }, plotlyConfig);
        }

        function renderMultilingualChart(multilingualData) {
            const colors = ['#3b82f6', '#10b981', '#f59e0b', '#ef4444'];
            const names = ['1 Language', '2 Languages', '3 Languages', '4+ Languages'];
            const keys = ['monolingual', 'bilingual', 'trilingual', 'quadlingual_plus'];
            const traces = keys.map((key, i) => ({
                x: multilingualData.map(d => d.year),
                y: multilingualData.map(d => d[key]),
                name: names[i],
                type: 'scatter',
                mode: 'lines',
                stackgroup: 'one',
                fillcolor: colors[i] + '80',
                line: { color: colors[i], width: 0 },
                hovertemplate: `<b>${names[i]}</b><br>%{y:.1f}%<extra></extra>`
            }));
            Plotly.newPlot('chart-multilingual', traces, {
                ...lightLayout,
                yaxis: { ...lightLayout.yaxis, title: { text: '% of websites', standoff: 15 }, range: [0, 100], ticksuffix: '%' },
                xaxis: { ...lightLayout.xaxis, dtick: 1 },
                legend: { orientation: 'h', y: -0.15, x: 0.5, xanchor: 'center', font: { size: 12 } }
            }, plotlyConfig);
        }

        function renderCombinationsChart(combinationsData) {
            const trace = [{
                y: combinationsData.map(d => d.combo).reverse(),
                x: combinationsData.map(d => d.pct).reverse(),
                type: 'bar',
                orientation: 'h',
                marker: {
                    color: combinationsData.map((_, i) =>
                        `hsl(${200 + (combinationsData.length - 1 - i) * 10}, 60%, ${45 + (combinationsData.length - 1 - i) * 3}%)`
                    ).reverse(),
                    line: { width: 0 }
                },
                text: combinationsData.map(d => `${d.pct}%`).reverse(),
                textposition: 'outside',
                textfont: { color: '#666', size: 11 },
                hovertemplate: '<b>%{y}</b><br>%{x:.1f}% of websites<extra></extra>'
            }];
            const maxPct = Math.max(...combinationsData.map(d => d.pct));
            Plotly.newPlot('chart-combinations', trace, {
                ...lightLayout,
                xaxis: { ...lightLayout.xaxis, title: { text: '% of websites', standoff: 15 }, ticksuffix: '%', range: [0, maxPct + 8] },
                yaxis: { ...lightLayout.yaxis, tickfont: { size: 11 }, automargin: true },
                showlegend: false,
                margin: { ...lightLayout.margin, l: 280 }
            }, plotlyConfig);
        }

        async function init() {
            const data = await loadData();
            populateContent(data);
            renderLanguageChart(data.yearly);
            renderMultilingualChart(data.multilingual);
            renderCombinationsChart(data.combinations);
            document.getElementById('loading').style.display = 'none';
            document.getElementById('content').classList.add('loaded');
        }

        init();
    </script>
</body>

</html>